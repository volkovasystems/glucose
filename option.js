"use strict";

/*;
	@submodule-license:
		The MIT License (MIT)
		@mit-license

		Copyright (@c) 2017 Richeve Siodina Bebedor
		@email: richeve.bebedor@gmail.com

		Permission is hereby granted, free of charge, to any person obtaining a copy
		of this software and associated documentation files (the "Software"), to deal
		in the Software without restriction, including without limitation the rights
		to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
		copies of the Software, and to permit persons to whom the Software is
		furnished to do so, subject to the following conditions:

		The above copyright notice and this permission notice shall be included in all
		copies or substantial portions of the Software.

		THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
		IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
		FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
		AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
		LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
		OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
		SOFTWARE.
	@end-submodule-license

	@submodule-configuration:
		{
			"package": "glucose",
			"path": "glucose/option.js",
			"file": "option.js",
			"module": "glucose",
			"author": "Richeve S. Bebedor",
			"contributors": [
				"John Lenon Maghanoy <johnlenonmaghanoy@gmail.com>"
			],
			"eMail": "richeve.bebedor@gmail.com",
			"repository": "https://github.com/volkovasystems/glucose.git",
			"test": "glucose-test.js",
			"class": true,
			"global": false
		}
	@end-submodule-configuration

	@submodule-documentation:
		Option class.
	@end-submodule-documentation

	@include:
		{
			"clazof": "clazof",
			"diatom": "diatom",
			"falze": "falze",
			"falzy": "falzy",
			"harden": "harden",
			"protype": "protype",
			"stuffed": "stuffed",
			"transpher": "transpher",
			"truly": "truly"
		}
	@end-include
*/

var _getOwnPropertyNames = require("babel-runtime/core-js/object/get-own-property-names");

var _getOwnPropertyNames2 = _interopRequireDefault(_getOwnPropertyNames);

var _symbol = require("babel-runtime/core-js/symbol");

var _symbol2 = _interopRequireDefault(_symbol);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var clazof = require("clazof");
var diatom = require("diatom");
var falze = require("falze");
var falzy = require("falzy");
var harden = require("harden");
var proplist = require("proplist");
var protype = require("protype");
var stuffed = require("stuffed");
var transpher = require("transpher");
var truly = require("truly");

harden("COATED", (0, _symbol2.default)("coated"));

var Option = diatom("Option");

/*;
	@option;
		{
			"self": "object"
			"factor": Array,
			"identity": "object",
			"setting": "object",
			"query": "object",
			"pagination": "object",
			"data": "object",
			"list": Array,
			"element": "object",
			"array": "object",
			"scope": Array,
			"permission": Array
		}
	@end-option
*/
Option.prototype.initialize = function initialize(option) {
	/*;
 	@meta-configuration:
 		{
 			"option:required": "object"
 		}
 	@end-meta-configuration
 */
	if (option.COATED === COATED) {
		transpher(option, this);

		return this;
	}

	harden("COATED", COATED, this);

	harden("self", option.self, this);

	harden("cache", option.cache || {}, this);

	/*;
 	These are standard conventional prooperties.
 */
	this.factor = option.factor || [];
	this.identity = option.identity || {};

	this.setting = option.setting || {};
	this.query = option.query || {};
	this.pagination = option.pagination || {};

	this.data = option.data || {};
	this.list = option.list || [];
	this.element = option.element || {};
	this.array = option.array || {};

	this.scope = option.scope || [];
	this.permission = option.permission || [];

	transpher(option, this);

	return this;
};

Option.prototype.get = function get(name) {
	/*;
 	@meta-configuration:
 		{
 			"name:required": "string"
 		}
 	@end-meta-configuration
 */

	if (falzy(name) || !protype(name, STRING)) {
		throw new Error("invalid name");
	}

	return this.cache[name];
};

Option.prototype.set = function set(name, value) {
	/*;
 	@meta-configuration:
 		{
 			"name:required": "string",
 			"value:required": "*"
 		}
 	@end-meta-configuration
 */

	if (falzy(name) || !protype(name, STRING)) {
		throw new Error("invalid name");
	}

	if (falzy(value)) {
		throw new Error("invalid value");
	}

	this.cache[name] = value;

	return this;
};

Option.prototype.clear = function clear(name) {
	/*;
 	@meta-configuration:
 		{
 			"name:required": "string"
 		}
 	@end-meta-configuration
 */

	if (truly(name) && !protype(name, STRING)) {
		throw new Error("invalid name");
	}

	if (truly(name)) {
		delete this.cache[name];
	} else {
		for (var property in this.cache) {
			delete this.cache[property];
		}
	}

	return this;
};

Option.prototype.mix = function mix(choice) {
	/*;
 	@meta-configuration:
 		{
 			"choice:required": Option
 		}
 	@end-meta-configuration
 */

	if (!clazof(choice, Option)) {
		choice = Option(choice);
	}

	if (truly(choice) && protype(choice, OBJECT) && clazof(choice, Option) && protype(choice.cache, OBJECT) && stuffed(choice.cache)) {
		for (var property in choice.cache) {
			this.cache[property] = choice.cache[property];
		}

		for (var _property in this.cache) {
			choice.cache[_property] = this.cache[_property];
		}
	}

	return this;
};

Option.prototype.empty = function empty(property) {
	var _this = this;

	/*;
 	@meta-configuration:
 		{
 			"property:required": "string"
 		}
 	@end-meta-configuration
 */

	if (truly(property) && !protype(property, STRING)) {
		throw new Error("invalid property");
	}

	if (truly(property)) {
		return falze(this[property]);
	} else {
		return (0, _getOwnPropertyNames2.default)(this).filter(function (property) {
			return property != "self" && property != "cache" && protype(_this[property], OBJECT, STRING, NUMBER, BOOLEAN, SYMBOL);
		}).every(function (property) {
			return falze(_this[property]);
		});
	}

	return this;
};

Option.prototype.toJSON = function toJSON() {
	var object = {};

	proplist(this).filter(function (property) {
		return property.enumerable;
	}).forEach(function (_ref) {
		var property = _ref.property,
		    value = _ref.value;

		object[property] = value;
	});

	return object;
};

module.exports = Option;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9wdGlvbi5tb2R1bGUuanMiXSwibmFtZXMiOlsiY2xhem9mIiwicmVxdWlyZSIsImRpYXRvbSIsImZhbHplIiwiZmFsenkiLCJoYXJkZW4iLCJwcm9wbGlzdCIsInByb3R5cGUiLCJzdHVmZmVkIiwidHJhbnNwaGVyIiwidHJ1bHkiLCJPcHRpb24iLCJwcm90b3R5cGUiLCJpbml0aWFsaXplIiwib3B0aW9uIiwiQ09BVEVEIiwic2VsZiIsImNhY2hlIiwiZmFjdG9yIiwiaWRlbnRpdHkiLCJzZXR0aW5nIiwicXVlcnkiLCJwYWdpbmF0aW9uIiwiZGF0YSIsImxpc3QiLCJlbGVtZW50IiwiYXJyYXkiLCJzY29wZSIsInBlcm1pc3Npb24iLCJnZXQiLCJuYW1lIiwiU1RSSU5HIiwiRXJyb3IiLCJzZXQiLCJ2YWx1ZSIsImNsZWFyIiwicHJvcGVydHkiLCJtaXgiLCJjaG9pY2UiLCJPQkpFQ1QiLCJlbXB0eSIsImZpbHRlciIsIk5VTUJFUiIsIkJPT0xFQU4iLCJTWU1CT0wiLCJldmVyeSIsInRvSlNPTiIsIm9iamVjdCIsImVudW1lcmFibGUiLCJmb3JFYWNoIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZ0VBLElBQU1BLFNBQVNDLFFBQVMsUUFBVCxDQUFmO0FBQ0EsSUFBTUMsU0FBU0QsUUFBUyxRQUFULENBQWY7QUFDQSxJQUFNRSxRQUFRRixRQUFTLE9BQVQsQ0FBZDtBQUNBLElBQU1HLFFBQVFILFFBQVMsT0FBVCxDQUFkO0FBQ0EsSUFBTUksU0FBU0osUUFBUyxRQUFULENBQWY7QUFDQSxJQUFNSyxXQUFXTCxRQUFTLFVBQVQsQ0FBakI7QUFDQSxJQUFNTSxVQUFVTixRQUFTLFNBQVQsQ0FBaEI7QUFDQSxJQUFNTyxVQUFVUCxRQUFTLFNBQVQsQ0FBaEI7QUFDQSxJQUFNUSxZQUFZ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QVlBRyxPQUFPQyxPQUFQLEdBQWlCeEMsTUFBakIiLCJmaWxlIjoib3B0aW9uLm1vZHVsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKjtcblx0QHN1Ym1vZHVsZS1saWNlbnNlOlxuXHRcdFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXHRcdEBtaXQtbGljZW5zZVxuXG5cdFx0Q29weXJpZ2h0IChAYykgMjAxNyBSaWNoZXZlIFNpb2RpbmEgQmViZWRvclxuXHRcdEBlbWFpbDogcmljaGV2ZS5iZWJlZG9yQGdtYWlsLmNvbVxuXG5cdFx0UGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuXHRcdG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcblx0XHRpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG5cdFx0dG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuXHRcdGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuXHRcdGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblx0XHRUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcblx0XHRjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5cdFx0VEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuXHRcdElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuXHRcdEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuXHRcdEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcblx0XHRMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuXHRcdE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG5cdFx0U09GVFdBUkUuXG5cdEBlbmQtc3VibW9kdWxlLWxpY2Vuc2VcblxuXHRAc3VibW9kdWxlLWNvbmZpZ3VyYXRpb246XG5cdFx0e1xuXHRcdFx0XCJwYWNrYWdlXCI6IFwiZ2x1Y29zZVwiLFxuXHRcdFx0XCJwYXRoXCI6IFwiZ2x1Y29zZS9vcHRpb24uanNcIixcblx0XHRcdFwiZmlsZVwiOiBcIm9wdGlvbi5qc1wiLFxuXHRcdFx0XCJtb2R1bGVcIjogXCJnbHVjb3NlXCIsXG5cdFx0XHRcImF1dGhvclwiOiBcIlJpY2hldmUgUy4gQmViZWRvclwiLFxuXHRcdFx0XCJjb250cmlidXRvcnNcIjogW1xuXHRcdFx0XHRcIkpvaG4gTGVub24gTWFnaGFub3kgPGpvaG5sZW5vbm1hZ2hhbm95QGdtYWlsLmNvbT5cIlxuXHRcdFx0XSxcblx0XHRcdFwiZU1haWxcIjogXCJyaWNoZXZlLmJlYmVkb3JAZ21haWwuY29tXCIsXG5cdFx0XHRcInJlcG9zaXRvcnlcIjogXCJodHRwczovL2dpdGh1Yi5jb20vdm9sa292YXN5c3RlbXMvZ2x1Y29zZS5naXRcIixcblx0XHRcdFwidGVzdFwiOiBcImdsdWNvc2UtdGVzdC5qc1wiLFxuXHRcdFx0XCJjbGFzc1wiOiB0cnVlLFxuXHRcdFx0XCJnbG9iYWxcIjogZmFsc2Vcblx0XHR9XG5cdEBlbmQtc3VibW9kdWxlLWNvbmZpZ3VyYXRpb25cblxuXHRAc3VibW9kdWxlLWRvY3VtZW50YXRpb246XG5cdFx0T3B0aW9uIGNsYXNzLlxuXHRAZW5kLXN1Ym1vZHVsZS1kb2N1bWVudGF0aW9uXG5cblx0QGluY2x1ZGU6XG5cdFx0e1xuXHRcdFx0XCJjbGF6b2ZcIjogXCJjbGF6b2ZcIixcblx0XHRcdFwiZGlhdG9tXCI6IFwiZGlhdG9tXCIsXG5cdFx0XHRcImZhbHplXCI6IFwiZmFsemVcIixcblx0XHRcdFwiZmFsenlcIjogXCJmYWx6eVwiLFxuXHRcdFx0XCJoYXJkZW5cIjogXCJoYXJkZW5cIixcblx0XHRcdFwicHJvdHlwZVwiOiBcInByb3R5cGVcIixcblx0XHRcdFwic3R1ZmZlZFwiOiBcInN0dWZmZWRcIixcblx0XHRcdFwidHJhbnNwaGVyXCI6IFwidHJhbnNwaGVyXCIsXG5cdFx0XHRcInRydWx5XCI6IFwidHJ1bHlcIlxuXHRcdH1cblx0QGVuZC1pbmNsdWRlXG4qL1xuXG5jb25zdCBjbGF6b2YgPSByZXF1aXJlKCBcImNsYXpvZlwiICk7XG5jb25zdCBkaWF0b20gPSByZXF1aXJlKCBcImRpYXRvbVwiICk7XG5jb25zdCBmYWx6ZSA9IHJlcXVpcmUoIFwiZmFsemVcIiApO1xuY29uc3QgZmFsenkgPSByZXF1aXJlKCBcImZhbHp5XCIgKTtcbmNvbnN0IGhhcmRlbiA9IHJlcXVpcmUoIFwiaGFyZGVuXCIgKTtcbmNvbnN0IHByb3BsaXN0ID0gcmVxdWlyZSggXCJwcm9wbGlzdFwiICk7XG5jb25zdCBwcm90eXBlID0gcmVxdWlyZSggXCJwcm90eXBlXCIgKTtcbmNvbnN0IHN0dWZmZWQgPSByZXF1aXJlKCBcInN0dWZmZWRcIiApO1xuY29uc3QgdHJhbnNwaGVyID0gcmVxdWlyZSggXCJ0cmFuc3BoZXJcIiApO1xuY29uc3QgdHJ1bHkgPSByZXF1aXJlKCBcInRydWx5XCIgKTtcblxuaGFyZGVuKCBcIkNPQVRFRFwiLCBTeW1ib2woIFwiY29hdGVkXCIgKSApO1xuXG5jb25zdCBPcHRpb24gPSBkaWF0b20oIFwiT3B0aW9uXCIgKTtcblxuLyo7XG5cdEBvcHRpb247XG5cdFx0e1xuXHRcdFx0XCJzZWxmXCI6IFwib2JqZWN0XCJcblx0XHRcdFwiZmFjdG9yXCI6IEFycmF5LFxuXHRcdFx0XCJpZGVudGl0eVwiOiBcIm9iamVjdFwiLFxuXHRcdFx0XCJzZXR0aW5nXCI6IFwib2JqZWN0XCIsXG5cdFx0XHRcInF1ZXJ5XCI6IFwib2JqZWN0XCIsXG5cdFx0XHRcInBhZ2luYXRpb25cIjogXCJvYmplY3RcIixcblx0XHRcdFwiZGF0YVwiOiBcIm9iamVjdFwiLFxuXHRcdFx0XCJsaXN0XCI6IEFycmF5LFxuXHRcdFx0XCJlbGVtZW50XCI6IFwib2JqZWN0XCIsXG5cdFx0XHRcImFycmF5XCI6IFwib2JqZWN0XCIsXG5cdFx0XHRcInNjb3BlXCI6IEFycmF5LFxuXHRcdFx0XCJwZXJtaXNzaW9uXCI6IEFycmF5XG5cdFx0fVxuXHRAZW5kLW9wdGlvblxuKi9cbk9wdGlvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIGluaXRpYWxpemUoIG9wdGlvbiApe1xuXHQvKjtcblx0XHRAbWV0YS1jb25maWd1cmF0aW9uOlxuXHRcdFx0e1xuXHRcdFx0XHRcIm9wdGlvbjpyZXF1aXJlZFwiOiBcIm9iamVjdFwiXG5cdFx0XHR9XG5cdFx0QGVuZC1tZXRhLWNvbmZpZ3VyYXRpb25cblx0Ki9cblx0aWYoIG9wdGlvbi5DT0FURUQgPT09IENPQVRFRCApe1xuXHRcdHRyYW5zcGhlciggb3B0aW9uLCB0aGlzICk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGhhcmRlbiggXCJDT0FURURcIiwgQ09BVEVELCB0aGlzICk7XG5cblx0aGFyZGVuKCBcInNlbGZcIiwgb3B0aW9uLnNlbGYsIHRoaXMgKTtcblxuXHRoYXJkZW4oIFwiY2FjaGVcIiwgb3B0aW9uLmNhY2hlIHx8IHsgfSwgdGhpcyApO1xuXG5cdC8qO1xuXHRcdFRoZXNlIGFyZSBzdGFuZGFyZCBjb252ZW50aW9uYWwgcHJvb3BlcnRpZXMuXG5cdCovXG5cdHRoaXMuZmFjdG9yID0gb3B0aW9uLmZhY3RvciB8fCBbIF07XG5cdHRoaXMuaWRlbnRpdHkgPSBvcHRpb24uaWRlbnRpdHkgfHwgeyB9O1xuXG5cdHRoaXMuc2V0dGluZyA9IG9wdGlvbi5zZXR0aW5nIHx8IHsgfTtcblx0dGhpcy5xdWVyeSA9IG9wdGlvbi5xdWVyeSB8fCB7IH07XG5cdHRoaXMucGFnaW5hdGlvbiA9IG9wdGlvbi5wYWdpbmF0aW9uIHx8IHsgfTtcblxuXHR0aGlzLmRhdGEgPSBvcHRpb24uZGF0YSB8fCB7IH07XG5cdHRoaXMubGlzdCA9IG9wdGlvbi5saXN0IHx8IFsgXTtcblx0dGhpcy5lbGVtZW50ID0gb3B0aW9uLmVsZW1lbnQgfHwgeyB9O1xuXHR0aGlzLmFycmF5ID0gb3B0aW9uLmFycmF5IHx8IHsgfTtcblxuXHR0aGlzLnNjb3BlID0gb3B0aW9uLnNjb3BlIHx8IFsgXTtcblx0dGhpcy5wZXJtaXNzaW9uID0gb3B0aW9uLnBlcm1pc3Npb24gfHwgWyBdO1xuXG5cdHRyYW5zcGhlciggb3B0aW9uLCB0aGlzICk7XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5PcHRpb24ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldCggbmFtZSApe1xuXHQvKjtcblx0XHRAbWV0YS1jb25maWd1cmF0aW9uOlxuXHRcdFx0e1xuXHRcdFx0XHRcIm5hbWU6cmVxdWlyZWRcIjogXCJzdHJpbmdcIlxuXHRcdFx0fVxuXHRcdEBlbmQtbWV0YS1jb25maWd1cmF0aW9uXG5cdCovXG5cblx0aWYoIGZhbHp5KCBuYW1lICkgfHwgIXByb3R5cGUoIG5hbWUsIFNUUklORyApICl7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCBcImludmFsaWQgbmFtZVwiICk7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5jYWNoZVsgbmFtZSBdO1xufTtcblxuT3B0aW9uLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiBzZXQoIG5hbWUsIHZhbHVlICl7XG5cdC8qO1xuXHRcdEBtZXRhLWNvbmZpZ3VyYXRpb246XG5cdFx0XHR7XG5cdFx0XHRcdFwibmFtZTpyZXF1aXJlZFwiOiBcInN0cmluZ1wiLFxuXHRcdFx0XHRcInZhbHVlOnJlcXVpcmVkXCI6IFwiKlwiXG5cdFx0XHR9XG5cdFx0QGVuZC1tZXRhLWNvbmZpZ3VyYXRpb25cblx0Ki9cblxuXHRpZiggZmFsenkoIG5hbWUgKSB8fCAhcHJvdHlwZSggbmFtZSwgU1RSSU5HICkgKXtcblx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiaW52YWxpZCBuYW1lXCIgKTtcblx0fVxuXG5cdGlmKCBmYWx6eSggdmFsdWUgKSApe1xuXHRcdHRocm93IG5ldyBFcnJvciggXCJpbnZhbGlkIHZhbHVlXCIgKTtcblx0fVxuXG5cdHRoaXMuY2FjaGVbIG5hbWUgXSA9IHZhbHVlO1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxuT3B0aW9uLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKCBuYW1lICl7XG5cdC8qO1xuXHRcdEBtZXRhLWNvbmZpZ3VyYXRpb246XG5cdFx0XHR7XG5cdFx0XHRcdFwibmFtZTpyZXF1aXJlZFwiOiBcInN0cmluZ1wiXG5cdFx0XHR9XG5cdFx0QGVuZC1tZXRhLWNvbmZpZ3VyYXRpb25cblx0Ki9cblxuXHRpZiggdHJ1bHkoIG5hbWUgKSAmJiAhcHJvdHlwZSggbmFtZSwgU1RSSU5HICkgKXtcblx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiaW52YWxpZCBuYW1lXCIgKTtcblx0fVxuXG5cdGlmKCB0cnVseSggbmFtZSApICl7XG5cdFx0ZGVsZXRlIHRoaXMuY2FjaGVbIG5hbWUgXTtcblxuXHR9ZWxzZXtcblx0XHRmb3IoIGxldCBwcm9wZXJ0eSBpbiB0aGlzLmNhY2hlICl7XG5cdFx0XHRkZWxldGUgdGhpcy5jYWNoZVsgcHJvcGVydHkgXTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdGhpcztcbn07XG5cbk9wdGlvbi5wcm90b3R5cGUubWl4ID0gZnVuY3Rpb24gbWl4KCBjaG9pY2UgKXtcblx0Lyo7XG5cdFx0QG1ldGEtY29uZmlndXJhdGlvbjpcblx0XHRcdHtcblx0XHRcdFx0XCJjaG9pY2U6cmVxdWlyZWRcIjogT3B0aW9uXG5cdFx0XHR9XG5cdFx0QGVuZC1tZXRhLWNvbmZpZ3VyYXRpb25cblx0Ki9cblxuXHRpZiggIWNsYXpvZiggY2hvaWNlLCBPcHRpb24gKSApe1xuXHRcdGNob2ljZSA9IE9wdGlvbiggY2hvaWNlICk7XG5cdH1cblxuXHRpZiggdHJ1bHkoIGNob2ljZSApICYmXG5cdFx0cHJvdHlwZSggY2hvaWNlLCBPQkpFQ1QgKSAmJlxuXHRcdGNsYXpvZiggY2hvaWNlLCBPcHRpb24gKSAmJlxuXHRcdHByb3R5cGUoIGNob2ljZS5jYWNoZSwgT0JKRUNUICkgJiZcblx0XHRzdHVmZmVkKCBjaG9pY2UuY2FjaGUgKSApXG5cdHtcblx0XHRmb3IoIGxldCBwcm9wZXJ0eSBpbiBjaG9pY2UuY2FjaGUgKXtcblx0XHRcdHRoaXMuY2FjaGVbIHByb3BlcnR5IF0gPSBjaG9pY2UuY2FjaGVbIHByb3BlcnR5IF07XG5cdFx0fVxuXG5cdFx0Zm9yKCBsZXQgcHJvcGVydHkgIGluIHRoaXMuY2FjaGUgKXtcblx0XHRcdGNob2ljZS5jYWNoZVsgcHJvcGVydHkgXSA9IHRoaXMuY2FjaGVbIHByb3BlcnR5IF07XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5PcHRpb24ucHJvdG90eXBlLmVtcHR5ID0gZnVuY3Rpb24gZW1wdHkoIHByb3BlcnR5ICl7XG5cdC8qO1xuXHRcdEBtZXRhLWNvbmZpZ3VyYXRpb246XG5cdFx0XHR7XG5cdFx0XHRcdFwicHJvcGVydHk6cmVxdWlyZWRcIjogXCJzdHJpbmdcIlxuXHRcdFx0fVxuXHRcdEBlbmQtbWV0YS1jb25maWd1cmF0aW9uXG5cdCovXG5cblx0aWYoIHRydWx5KCBwcm9wZXJ0eSApICYmICFwcm90eXBlKCBwcm9wZXJ0eSwgU1RSSU5HICkgKXtcblx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiaW52YWxpZCBwcm9wZXJ0eVwiICk7XG5cdH1cblxuXHRpZiggdHJ1bHkoIHByb3BlcnR5ICkgKXtcblx0XHRyZXR1cm4gZmFsemUoIHRoaXNbIHByb3BlcnR5IF0gKTtcblxuXHR9ZWxzZXtcblx0XHRyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoIHRoaXMgKVxuXHRcdFx0LmZpbHRlciggKCBwcm9wZXJ0eSApID0+IHtcblx0XHRcdFx0cmV0dXJuICggcHJvcGVydHkgIT0gXCJzZWxmXCIgJiZcblx0XHRcdFx0XHRwcm9wZXJ0eSAhPSBcImNhY2hlXCIgJiZcblx0XHRcdFx0XHRwcm90eXBlKCB0aGlzWyBwcm9wZXJ0eSBdLCBPQkpFQ1QsIFNUUklORywgTlVNQkVSLCBCT09MRUFOLCBTWU1CT0wgKSApO1xuXHRcdFx0fSApXG5cdFx0XHQuZXZlcnkoICggcHJvcGVydHkgKSA9PiB7IHJldHVybiBmYWx6ZSggdGhpc1sgcHJvcGVydHkgXSApOyB9ICk7XG5cdH1cblxuXHRyZXR1cm4gdGhpcztcbn07XG5cbk9wdGlvbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gdG9KU09OKCApe1xuXHRsZXQgb2JqZWN0ID0geyB9O1xuXG5cdHByb3BsaXN0KCB0aGlzIClcblx0XHQuZmlsdGVyKCAoIHByb3BlcnR5ICkgPT4geyByZXR1cm4gcHJvcGVydHkuZW51bWVyYWJsZTsgfSApXG5cdFx0LmZvckVhY2goICggeyBwcm9wZXJ0eSwgdmFsdWUgfSApID0+IHtcblx0XHRcdG9iamVjdFsgcHJvcGVydHkgXSA9IHZhbHVlO1xuXHRcdH0gKTtcblxuXHRyZXR1cm4gb2JqZWN0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBPcHRpb247XG4iXX0=
